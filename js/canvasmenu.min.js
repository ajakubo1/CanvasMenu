function Menu(t,i,e,s){var n=this;this.buttons=[],this.canvas=t,this.width=i,this.height=e,this.canvas.width=i,this.canvas.height=e,this.ctx=t.getContext("2d"),this.scaleX=1,this.scaleY=1,this.focused=void 0,this.animated=s?!0:!1,this.running=!1,this.updateTime=void 0,this.tickLength=16.66666666,this.tickCount=0,this.tickMax=60,this.listener_mousedown=function(t){var i=t.pageX*n.scaleX-this.offsetLeft,e=t.pageY*n.scaleY-this.offsetTop;n.focused.inRange(i,e)&&(n.focused.setState(BUTTON_ENUM.down),n.focused.redrawBackground(n.tickCount),n.animated||n.redrawButtons())},this.listener_mousemove=function(t){var i,e=t.pageX*n.scaleX-this.offsetLeft,s=t.pageY*n.scaleY-this.offsetTop;for(void 0!==n.focused&&(n.focused.inRange(e,s)||(n.focused.setState(BUTTON_ENUM.inactive),n.focused=void 0,n.animated||n.redrawButtons())),i=0;i<n.buttons.length;i+=1)if(n.buttons[i].inRange(e,s)){n.focused=n.buttons[i],n.buttons[i].setState(BUTTON_ENUM.focused),n.animated||n.redrawButtons();break}},this.listener_mouseup=function(t){var i=t.pageX*n.scaleX-this.offsetLeft,e=t.pageY*n.scaleY-this.offsetTop;n.focused.inRange(i,e)&&(n.focused.setState(BUTTON_ENUM.up),n.animated||n.redrawButtons(),n.focused.click(),n.focused.redrawBackground(n.tickCount))},this.redrawButtons=function(){var i;for(this.animated?this.redrawBackground():this.ctx.clearRect(0,0,t.width,t.height),i=0;i<this.buttons.length;i+=1)this.ctx.drawImage(this.buttons[i].getCanvas(),this.buttons[i].getX(),this.buttons[i].getY())},this.redrawBackground=s,this.run=function(t){if(n.running){var i,e=Math.floor((t-n.updateTime)/n.tickLength);if(e>0){for(n.updateTime+=e*n.tickLength,n.tickCount+=e,n.tickCount>n.tickMax&&(n.tickCount=0),i=0;i<n.buttons.length;i+=1)n.buttons[i].redrawBackground(n.tickCount);n.redrawButtons()}window.requestAnimationFrame(n.run)}}}function Button(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.x_limit=this.x+this.width,this.y_limit=this.y+this.height,this.state=BUTTON_ENUM.inactive,this.canvas_inactive=document.createElement("canvas"),this.canvas_inactive.width=this.width,this.canvas_inactive.height=this.height,this.tick=0,this.text=t.text,this.canvas_focused=document.createElement("canvas"),this.canvas_focused.width=this.width,this.canvas_focused.height=this.height,this.canvas_down=document.createElement("canvas"),this.canvas_down.width=this.width,this.canvas_down.height=this.height,this.canvas_up=document.createElement("canvas"),this.canvas_up.width=this.width,this.canvas_up.height=this.height,this.redraw=function(){this.state===BUTTON_ENUM.inactive?this.redrawInactive():this.state===BUTTON_ENUM.focused?this.redrawFocused():this.state===BUTTON_ENUM.down?this.redrawDown():this.state===BUTTON_ENUM.up&&this.redrawUp()},this.redrawInactive=function(){var i=this.canvas_inactive.getContext("2d");i.clearRect(0,0,this.width,this.height),t.redrawInactive?t.redrawInactive.call(this,i):(i.fillStyle=t.redrawInactiveColor||"green",i.fillRect(0,0,this.width,this.height),i.font="30pt Arial",i.textAlign="center",i.fillStyle="white"),i.fillText(this.text,this.width/2,(this.height-30)/2+30)},this.redrawInactive(),this.redrawFocused=function(){var i=this.canvas_focused.getContext("2d");i.clearRect(0,0,this.width,this.height),t.redrawFocused?t.redrawFocused.call(this,i):(i.fillStyle=t.redrawFocusedColor||"blue",i.fillRect(0,0,this.width,this.height),i.font="30pt Arial",i.textAlign="center",i.fillStyle="white"),i.fillText(this.text,this.width/2,(this.height-30)/2+30)},this.redrawFocused(),this.redrawDown=function(){var i=this.canvas_down.getContext("2d");i.clearRect(0,0,this.width,this.height),t.redrawDown?t.redrawDown.call(this,i):(i.fillStyle=t.redrawDownColor||"red",i.fillRect(0,0,this.width,this.height),i.font="30pt Arial",i.textAlign="center",i.fillStyle="white"),i.fillText(this.text,this.width/2,(this.height-30)/2+30)},this.redrawDown(),this.redrawUp=function(){var i=this.canvas_up.getContext("2d");i.clearRect(0,0,this.width,this.height),t.redrawUp?t.redrawUp.call(this,i):(i.fillStyle=t.redrawUpColor||"orange",i.fillRect(0,0,this.width,this.height),i.font="30pt Arial",i.textAlign="center",i.fillStyle="black"),i.fillText(this.text,this.width/2,(this.height-30)/2+30)},this.redrawUp()}Menu.prototype.init=function(){this.canvas.addEventListener("mouseup",this.listener_mouseup),this.canvas.addEventListener("mousedown",this.listener_mousedown),this.canvas.addEventListener("mousemove",this.listener_mousemove),this.redrawButtons(),this.running=!0,this.animated&&(this.updateTime=window.performance.now(),window.requestAnimationFrame(this.run))},Menu.prototype.destroy=function(){var t;for(this.canvas.removeEventListener("mouseup",this.listener_mouseup),this.canvas.removeEventListener("mousedown",this.listener_mousedown),this.canvas.removeEventListener("mousemove",this.listener_mousemove),t=0;t<this.buttons.length;t+=1)this.buttons[t].setState(BUTTON_ENUM.inactive),this.redrawButtons();this.running=!1},Menu.prototype.appendButton=function(t){this.buttons.push(t),t.setParentMenu(this)};var BUTTON_ENUM={inactive:0,focused:1,down:2,up:3};Button.prototype.inRange=function(t,i){return t>=this.x&&t<=this.x_limit&&i>=this.y&&i<=this.y_limit?!0:!1},Button.prototype.setState=function(t){this.state=t,this.tick=0},Button.prototype.redrawBackground=function(t){this.tick=t,this.redraw()},Button.prototype.getCanvas=function(){return this.state===BUTTON_ENUM.inactive?this.canvas_inactive:this.state===BUTTON_ENUM.focused?this.canvas_focused:this.state===BUTTON_ENUM.down?this.canvas_down:this.state===BUTTON_ENUM.up?this.canvas_up:void 0},Button.prototype.getX=function(){return this.x},Button.prototype.getY=function(){return this.y},Button.prototype.setParentMenu=function(t){this.menu=t},Button.prototype.clickHandler=function(t){this.onclick=t},Button.prototype.click=function(){this.onclick instanceof Menu?(this.menu.destroy(),this.onclick.init()):void 0!==this.onclick&&this.onclick.call()};
//# sourceMappingURL=js/canvasmenu.map