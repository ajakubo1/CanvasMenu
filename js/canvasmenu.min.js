function Menu(t){var e=this;this.buttons=[],this.canvas=t.canvas,this.width=t.width,this.height=t.height,this.canvas.width=this.width,this.canvas.height=this.height,this.ctx=this.canvas.getContext("2d"),this.scaleX=1,this.scaleY=1,this.focused=void 0,this.animated=t.animation?!0:!1,this.running=!1,this.updateTime=void 0,this.tickLength=1e3/60,this.tickCount=0,this.tickMax=t.tickMax||Number.MAX_VALUE,this.autorescale=t.autorescale||!1,this.listener_mousedown=function(t){var i=(t.pageX-this.offsetLeft)/e.scaleX,s=(t.pageY-this.offsetTop)/e.scaleY;void 0!==e.focused&&e.focused.inRange(i,s)&&(e.swapButtonState(BUTTON_ENUM.down),e.focused.redrawBackground(e.tickCount))},this.listener_mousemove=function(t){var i,s=(t.pageX-this.offsetLeft)/e.scaleX,n=(t.pageY-this.offsetTop)/e.scaleY;for(void 0!==e.focused&&(e.focused.inRange(s,n)||(e.swapButtonState(BUTTON_ENUM.inactive),e.focused=void 0)),i=0;i<e.buttons.length;i+=1)if(e.buttons[i].inRange(s,n)){e.focused=e.buttons[i],e.swapButtonState(BUTTON_ENUM.focused);break}},this.listener_mouseup=function(t){var i=(t.pageX-this.offsetLeft)/e.scaleX,s=(t.pageY-this.offsetTop)/e.scaleY;void 0!==e.focused&&e.focused.inRange(i,s)&&(e.swapButtonState(BUTTON_ENUM.up),e.focused.redrawBackground(e.tickCount),e.focused.click())},this.swapButtonState=function(t){e.focused.setState(t),e.animated||e.redrawButtons()},this.redrawButtons=function(){var t;for(this.animated?this.redrawBackground():this.ctx.clearRect(0,0,this.width,this.height),t=0;t<this.buttons.length;t+=1)this.ctx.drawImage(this.buttons[t].getCanvas(),this.buttons[t].getX(),this.buttons[t].getY())},this.rescale=function(){var t,i=window.getComputedStyle(e.canvas,null),s=i.getPropertyValue("-webkit-transform")||i.getPropertyValue("-moz-transform")||i.getPropertyValue("-ms-transform")||i.getPropertyValue("-o-transform")||i.getPropertyValue("transform")||void 0;s&&(t=s.split("(")[1],t=t.split(")")[0],t=t.split(","),e.scaleX=t[0],e.scaleY=t[3])},this.redrawBackground=t.animation,this.run=function(t){if(e.running){var i,s=Math.floor((t-e.updateTime)/e.tickLength);if(s>0){for(e.updateTime+=s*e.tickLength,e.tickCount+=s,e.tickCount>e.tickMax&&(e.tickCount=0),i=0;i<e.buttons.length;i+=1)e.buttons[i].redrawBackground(e.tickCount);e.redrawButtons()}window.requestAnimationFrame(e.run)}}}function Button(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this.x_limit=this.x+this.width,this.y_limit=this.y+this.height,this.state=BUTTON_ENUM.inactive,this.tick=0,this.text=t.text,this.font=t.font||3*this.height/5+"pt Arial",this.init_canvas=function(){var t=document.createElement("canvas");return t.width=this.width,t.height=this.height,t},this.canvas_inactive=this.init_canvas(),this.canvas_focused=this.init_canvas(),this.canvas_down=this.init_canvas(),this.canvas_up=this.init_canvas(),this.redraw=function(){this.state===BUTTON_ENUM.inactive?this.redrawInactive():this.state===BUTTON_ENUM.focused?this.redrawFocused():this.state===BUTTON_ENUM.down?this.redrawDown():this.state===BUTTON_ENUM.up&&this.redrawUp()},this.redraw_button=function(t,e,i,s){t.clearRect(0,0,this.width,this.height),e?e.call(this,t):(t.fillStyle=i,t.fillRect(0,0,this.width,this.height)),t.font=this.font,t.textAlign="center",t.textBaseline="middle",t.fillStyle=s,t.fillText(this.text,this.width/2,this.height/2)},this.redrawInactive=function(){this.redraw_button(this.canvas_inactive.getContext("2d"),t.redrawInactive,t.redrawInactiveColor||"green",t.redrawInactiveFont||"white")},this.redrawInactive(),this.redrawFocused=function(){this.redraw_button(this.canvas_focused.getContext("2d"),t.redrawFocused,t.redrawFocusedColor||"blue",t.redrawFocusedFont||"white")},this.redrawFocused(),this.redrawDown=function(){this.redraw_button(this.canvas_down.getContext("2d"),t.redrawDown,t.redrawDownColor||"red",t.redrawDownFont||"white")},this.redrawDown(),this.redrawUp=function(){this.redraw_button(this.canvas_up.getContext("2d"),t.redrawUp,t.redrawUpColor||"orange",t.redrawUpFont||"white")},this.redrawUp()}Menu.prototype.init=function(){this.canvas.addEventListener("mouseup",this.listener_mouseup),this.canvas.addEventListener("mousedown",this.listener_mousedown),this.canvas.addEventListener("mousemove",this.listener_mousemove),this.redrawButtons(),this.running=!0,this.autorescale&&(window.addEventListener("resize",this.rescale),this.rescale()),this.animated&&(this.updateTime=window.performance.now(),window.requestAnimationFrame(this.run))},Menu.prototype.destroy=function(){var t;for(this.canvas.removeEventListener("mouseup",this.listener_mouseup),this.canvas.removeEventListener("mousedown",this.listener_mousedown),this.canvas.removeEventListener("mousemove",this.listener_mousemove),this.autorescale&&window.removeEventListener("resize",this.rescale),t=0;t<this.buttons.length;t+=1)this.buttons[t].setState(BUTTON_ENUM.inactive),this.redrawButtons();this.running=!1},Menu.prototype.appendButton=function(t){this.buttons.push(t),t.setParentMenu(this)},Menu.prototype.updateScale=function(t){this.scaleX=t,this.scaleY=t},Menu.prototype.updateScaleX=function(t){this.scaleX=t},Menu.prototype.updateScaleY=function(t){this.scaleY=t};var BUTTON_ENUM={inactive:0,focused:1,down:2,up:3};Button.prototype.inRange=function(t,e){return t>=this.x&&t<=this.x_limit&&e>=this.y&&e<=this.y_limit?!0:!1},Button.prototype.setState=function(t){this.state=t,this.tick=0},Button.prototype.redrawBackground=function(t){this.tick=t,this.redraw()},Button.prototype.getCanvas=function(){return this.state===BUTTON_ENUM.inactive?this.canvas_inactive:this.state===BUTTON_ENUM.focused?this.canvas_focused:this.state===BUTTON_ENUM.down?this.canvas_down:this.state===BUTTON_ENUM.up?this.canvas_up:void 0},Button.prototype.getX=function(){return this.x},Button.prototype.getY=function(){return this.y},Button.prototype.setParentMenu=function(t){this.menu=t},Button.prototype.clickHandler=function(t){this.onclick=t},Button.prototype.click=function(){this.onclick instanceof Menu?(this.menu.destroy(),this.onclick.init()):void 0!==this.onclick&&this.onclick.call()};
//# sourceMappingURL=js/canvasmenu.map